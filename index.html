<!DOCTYPE html>
<html>
    <head>
        <title>My experiment</title>
        <script src="https://unpkg.com/jspsych@7.3.3"></script>
        <link href="https://unpkg.com/jspsych@7.3.3/css/jspsych.css" rel="stylesheet" type="text/css" />
        <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.2"></script>
        <script src="https://unpkg.com/@jspsych/plugin-survey-text@1.1.2"></script>
        <script src="jspsych/modified-image-plugin.js"></script>
        <script src="sentences.js"></script>
        <script src="association.js"></script>
        <script src="priming.js"></script>

    </head>
    <body>
        
    </body>
    <script>
        const jsPsych = initJsPsych();

        var sentence = {
            type: jsPsychHtmlKeyboardResponse,
            stimulus: jsPsych.timelineVariable('sentence'),
            choices: [' '],
            trial_duration: 10
        }

        var training_procedure = {
            timeline: [sentence],
            timeline_variables: sentences,
            randomize_order: true
        }

        var attention = {
            type: jsPsychSurveyText,
            questions: [{prompt:"Type any ONE novel word from the previous sentence:"}, 
            {prompt:"What are the vibes rn?:"}],
        }

        var association = {
            type: jsPsychSurveyText,
            questions: [{prompt:jsPsych.timelineVariable('cue')}]
        }

        var association_procedure = {
            timeline: [association],
            timeline_variables: association_cues,
            randomize_order: true,
            repetitions: 3

        }
        
        var training_plus_association = {
            timeline: [training_procedure, association_procedure],
            repetitions: 3
        }

        //priming
        var fixation = {
            type: jsPsychHtmlKeyboardResponse,
            stimulus: '+',
            choices: "NO_KEYS",
            trial_duration: 500
        }

        var image = {
            type: jsPsychImageKeyboardResponse,
            stimulus: jsPsych.timelineVariable('image_path'),
            choices: "NO_KEYS",
            trial_duration: 1000,
            stimulus_height: 500,
            prompt: "<span style = 'font-size:200%'><br></br></span>"
        }

        var prime = {
            type: jsPsychImageKeyboardResponse,
            stimulus: jsPsych.timelineVariable('image_path'),
            choices: "NO_KEYS",
            trial_duration: 1000,
            stimulus_height: 500,
            prompt: function () {
                return "<span style = 'font-size:200%'><br>" + String(jsPsych.timelineVariable('prime_word')) + "</br></span>"
            },
        }

        var target = {
            type: jsPsychImageKeyboardResponse,
            stimulus: jsPsych.timelineVariable('image_path'),
            choices: ['A', 'L'],
            stimulus_height: 500,
            prompt: function () {
                return "<span style = 'font-size:200%'><br>" + String(jsPsych.timelineVariable('target_word')) + "</br></span>"
            },
        }

        var priming_proc = {
            timeline: [fixation, image, prime, target],
            timeline_variables: practice_stimuli,
            randomize_order : true
        }

        //jsPsych.run([sentence, attention, association, fixation, image, prime, target]);
        jsPsych.run([training_plus_association, priming_proc]);

    </script>
</html>